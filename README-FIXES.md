# Исправления для устранения предупреждений Docker Compose

## Проблема

При выполнении скриптов (`install.sh`, `diagnose-web.sh`, `check-nginx.sh`, `fix-database-path.sh`) появляются множественные предупреждения:

```
WARN[0000] The "mmGPyMm7N30ipQfiLSqdtOPbFBNNvshTV3Dd242GFK0Wd8DNCEAiW" variable is not set. Defaulting to a blank string.
```

Это происходит из-за того, что в `.env` файле есть переменные, которые выглядят как случайные строки без значения.

## Решения

### 1. Очистка .env файла

Запустите скрипт для очистки `.env` файла от некорректных переменных:

```bash
chmod +x fix-env-variables.sh
./fix-env-variables.sh
```

Этот скрипт:
- Создает резервную копию `.env` файла
- Удаляет переменные, которые выглядят как случайные строки (длиннее 50 символов, содержат смешанные регистры и цифры)
- Удаляет переменные без значения (кроме специальных, таких как `NODE_ENV`, `SKIP_*`, `NO_*`)
- Сохраняет все корректные переменные

### 2. Подавление предупреждений в скриптах

Все скрипты обновлены для подавления предупреждений о переменных:

- `install.sh` - функция `run_compose()` теперь фильтрует предупреждения
- `diagnose-web.sh` - добавлена функция `run_compose()` с фильтрацией
- `check-nginx.sh` - добавлена функция `run_compose()` с фильтрацией
- `fix-database-path.sh` - обновлена функция `run_compose()` с фильтрацией

### 3. Улучшенная диагностика таблиц

Скрипт `diagnose-web.sh` теперь:
- Проверяет ВСЕ таблицы в `sqlite_master` (включая системные)
- Проверяет пользовательские таблицы отдельно
- Проверяет наличие пользователей через Prisma Client, даже если `sqlite_master` пуст
- Выводит подробную диагностическую информацию

## Использование

### Очистка .env файла

```bash
./fix-env-variables.sh
```

### Проверка после очистки

```bash
./diagnose-web.sh
```

### Проверка Nginx

```bash
./check-nginx.sh
```

## Примечания

- Резервная копия `.env` создается автоматически с временной меткой
- Если после очистки что-то не работает, восстановите из резервной копии:
  ```bash
  cp .env.backup.YYYYMMDD_HHMMSS .env
  ```
- Предупреждения о переменных теперь подавляются во всех скриптах, но это не решает проблему некорректных переменных в `.env`
- Рекомендуется запустить `fix-env-variables.sh` для полной очистки

